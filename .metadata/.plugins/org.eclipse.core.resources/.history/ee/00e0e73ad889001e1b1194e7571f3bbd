// console.log("전체 업체 개수 : " + listLength);
// var remainder = listLength % 2;
// console.log("나머지 : " + remainder);
// //오른쪽 : 줄이기

// if (remainder === 1) {
//     const lastLi = document.querySelector(".listContainer ul li:last-child");
//     lastLi.style.marginRight = "376px";
// }

async function spreadStoreFromServer(page, type){
    try{
        const resp = await fetch('/store/'+page+'/'+type);
        const result = await resp.json();
        return result;
    }catch(err){
        console.log(err);
    }
}

//페이지가 처음 로드될 때 전체 업체 표시
function getStoreList(page = 1, type = null) {
    spreadStoreFromServer(page, type).then(result => {
        console.log(result);
        const ul = document.getElementById('ulZone');
        const moreBtn = document.getElementById('moreBtn');

        if (page === 1) {
            ul.innerHTML = "";
        }

        if (result.prodList.length > 0) {
            for (let sbo of result.prodList) {
                // li 생성
                const li = document.createElement('li');
                li.innerHTML = `
                    <a href="/store/detail?bno=${sbo.proBno}">
                        <div>
                            <div>
                                <img class="profile" alt="../resources/image/logoimage.png" src="">
                            </div>
                        </div>
                        <div>
                            <div>
                                <span class="title">${sbo.proTitle}</span>
                                <span class="gray">주소</span>
                            </div>
                            <span class="content">${sbo.proContent}</span>
                            <span class="gray">${sbo.proMenu}</span>
                        </div>
                    </a>
                `;
                // li 추가
                ul.appendChild(li);
            }

            if (result.pgvo.pageNo < result.endPage) {
                moreBtn.style.visibility = 'visible';
                moreBtn.dataset.page = page + 1;
            } else {
                moreBtn.style.visibility = 'hidden';
            }
        } else {
            // result.prodList가 비어있는 경우
            const noResultMessage = document.createElement('div');
            noResultMessage.innerText = '검색 결과가 없습니다.';
            ul.appendChild(noResultMessage);
            moreBtn.style.visibility = 'hidden';
        }
    });
}

let type = null;

document.addEventListener('click', (e) => {
    const targetId = e.target.id;
    if (targetId === 'all' || targetId === 'lesson' || targetId === 'pet' || targetId === 'hospital' || targetId === 'beauty' || targetId === 'laundry' || targetId === 'repair' || targetId === 'sports' || targetId === 'infant' || targetId === 'eatery' || targetId === 'move' || targetId === 'interior' || targetId === 'cleaning' || targetId === 'hobby' || targetId === 'dessert') {
        type = e.target.value;
        getStoreList(1, type);
    }
    
    if (targetId === 'moreBtn') {
        getStoreList(parseInt(e.target.dataset.page), type);
    } 

});

// async function setThumbnail() {
//     const thumbnails = document.querySelectorAll('.thumbnail');
//     for (const thumbnail of thumbnails) {
//         const bno = thumbnail.dataset.bno;
//         const imagePath = await getThumbnail(bno); 
//         thumbnail.src = imagePath;
//     }
// }

// // 페이지 로드 후 setThumbnail 함수 호출
// window.onload = function() {
//     setThumbnail();
// };

// // 이미지 경로를 가져오고 설정하는 함수
// async function getThumbnail(bno) {
//     try {
//         const resp = await fetch('/store/'+bno);
//         const result = await resp.json();
//         return result.imagePath;
//     } catch (err) {
//         console.log(err);
//     }
// }