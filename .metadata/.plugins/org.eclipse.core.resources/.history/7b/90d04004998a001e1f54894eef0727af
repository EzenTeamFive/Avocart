//파일 첨부
document.getElementById('trigger').addEventListener('click',()=>{
    document.getElementById('files').click();
});
 
const regExpImg = new RegExp("\.(jpg|jpeg|png|gif)$");
const maxSize = 1024*1024*20; 

function fileValidation(fileName, fileSize){
    if(!regExpImg.test(fileName)){
        return 0;
    }else 
    if(fileSize > maxSize){
        return 0;
    }else {
        return 1;
    }
}

document.addEventListener('change', (e) => {
    if (e.target.id == 'files') {
        document.getElementById('regBtn').disabled = false;
        const fileObj = document.getElementById('files').files;
        let div = document.getElementById('fileZone');
        div.innerHTML = "";
        let isOk = 1;
        let ul = `<ul>`;

        for (let file of fileObj) {
            let validResult = fileValidation(file.name, file.size);
            isOk *= validResult;

            if (validResult) {
                ul += `<li>`;
                ul += `<div>`;

                var reader = new FileReader();
                reader.onload = function(e) {
                    var img = document.createElement("img");
                    img.setAttribute("src", e.target.result);
                    img.setAttribute("style", "max-width: 100px; max-height: 100px; margin-right: 10px;");
                    document.querySelector("div#fileZone").appendChild(img);
                };
                reader.readAsDataURL(file);
                ul += `</div>`;
                ul += `</li>`;
            }
        }
        ul += `</ul>`;
        div.innerHTML = ul;

        if (isOk == 0) {
            document.getElementById('regBtn').disabled = true;
        }
    }
});

//등록 버튼 클릭 시 alert
document.getElementById('regBtn').addEventListener('click', (e) => {
    var selectedValue = document.getElementById('proMenu').value;
    var titleValue = document.getElementById('title').value;
    var contentValue = document.getElementById('content').value;

    if (selectedValue === "unselect") {
        alert("옵션을 선택해 주세요.");
        //폼 제출 막음
        e.preventDefault();
    } else {
        if (titleValue == "" || titleValue == null || contentValue == "" || contentValue == null) {
            alert("빈칸을 입력해 주세요.");
            e.preventDefault();
        }
    }
});

let clickCount = 0;

//메뉴 추가
// document.addEventListener('click', (e) => {
//     let div = document.getElementById('menuZone');
//     let ul = `<ul>`;

//     if (e.target.id === 'addMenu') {
//         clickCount++;
//         //let div = document.getElementById('menuZone');
//         //div.innerHTML = "";

       
//             ul += `<li>`;
//             ul += `<div>`;
//             ul += `메뉴명 : <input type="text" name="menu" class="menu" >`;
//             ul += ` 가격 : <input type="text" name="price" class="price">`;
//             ul += ` 설명 : <input type="text" name="explain" class="explain">`;
//             ul += `<button type="button" class="menu-x">X</button>`
//             ul += `</div>`;
//             ul += `</li>`;
        

//         ul += `</ul>`;
//         div.innerHTML = ul;
//     } else if (e.target.classList.contains('menu-x')) {
//         // menu-x 클래스를 가진 버튼이 클릭된 경우
//         e.target.closest('li').remove();
//         clickCount--;
//     }
// })


//메뉴 추가
document.addEventListener('click', (e) => {
    let div = document.getElementById('menuZone');
    let ul = document.getElementById("menuContainer");

    if (e.target.id === 'addMenu') {
        console.log(e.target.id);
        let li = document.createElement('li');
        li.innerHTML = `
            메뉴명 : <input type="text" name="menu" class="menu">
            가격 : <input type="text" name="price" class="price">
            설명 : <input type="text" name="explain" class="explain">
            <button type="button" class="menu-x">X</button>
        `;

        ul.appendChild(li);
    }
});